<VirtualHost *:<%= @params[:port] || 80 %>>
  ServerName <%= @params[:server_name] %>
  DocumentRoot <%= @params[:docroot] %>
  CustomLog <%= node['apache']['log_dir'] %>/access-poirot.log combined
  PassengerUser <%= @params[:user] %>

  <% if @params[:use_auth] %>
  <Location / >
    AuthType basic
    AuthName "Poirot web interface"
    AuthBasicProvider file
    AuthUserFile <%= node['apache']['dir'] %>/poirot.htpasswd
    Require valid-user
  </Location>
  <% end %>
</VirtualHost>
